# Estimating functional discriminability across the brain using large-scale classification
by Alejandro de la Vega

## Introduction

Mapping cognitive functions to brain anatomy is central to understanding the functional organization of the human brain. To this end, many functional magnetic resonance imaging (fMRI) studies scan participants while they perform a task purported to elicit a cognitive process to observe which regions activate. These types of studies has led to the discovery of areas that reliably activate for specific processes, such as the fusiform face area for face perception. However, the information that can be gleaned from any one study is limited by the scope of cognitive processes studied and noise inherent to brain measurement. This is especially problematic given that there is likely a many-to-many mapping between functions and regions, such that regions perform multiple functions and functions activate multiple regions. 

Fortunately, the recent development of large-scale neuroimaging databases, such as Neurosynth and BrainMap, have enabled a new breed of approaches that harness the power of many studies to make more robust and nuanced inferences about brain function. Due to the breadth of cognitive processes present in these databases, we can determine which functions specifically activate certain regions, over and above other processes. For example, these databases have been used to describe the processes that best characterize activity in subregions of the insula (Chang et al.) and ventromedial prefrontal cortex, (Roy et al.,), as well the diversity of function across the brain (Anderson et al., ). While these analyses are useful in determining what the most associated functions are for different regions, it is unclear how well we can predict brain activity by knowing the context of a study. In other words, given we know what a study was about, how well can predict if that study activated a particular region? 

In the present study, we trained machine learning classifiers to discriminate studies in Neurosynth that activated a particular region from those that didn’t using the content of fMRI studies. We quantified ‘discriminability’ for discrete brain regions across the brain, and queried the fitted models to determine which cognitive functions were most useful in predicting brain activity. We hypothesized that regions would vary in how well we could predict which studies activate them, and that the discriminability of a region is indicative of its functional specialization. Presumably, regions that have strong associations with specific, coherent cognitive functions, such as visual cortex with ‘vision’, should be easier to discriminate than regions with less consistent mappings between function and structure, such as frontal pole. We also quantified how many cognitive functions one needs for successful classification for each region, as a measure of the complexity of a region’s function. We hypothesized that regions with a fairly specific functions would require fewer features for successful classification, while those with broader, less identifiable functions would require more. 

Next, we used classification as a way to quantify differences between regions in their cognitive function by attempting to discriminate studies that activated one region, versus those that activated a different one. We hypothesized that regions that are closer in cognitive function would be more difficult to discriminate, and examined the models’ weights to infer which functions differentiate specific pairs of regions. Finally, we used this analysis to test if regions within networks defined externally using resting state functional connectivity would be more difficult to discriminate from pairs of regions from different networks. 

## Methods
### Discriminability across the brain
We analyzed the Neurosynth database (neurosynth.org), a repository of 9,721 fMRI studies and over 700,000 activations. Each observation in the database contains the peak activations for all contrasts reported in a study’s table as well as the frequency of all of the words in the body of the text. Although meta-analyses of cognitively relevant words yield activation maps consistent with neuroscientific knowledge, there is a high amount of redundancy between words (e.g. ‘memory’ and ‘episodic’) and potential ambiguity as to the meaning of an individual word out of context. Thus, we employed a set of 80 topics derived using latent dirichlet allocation topic-modeling (see Poldrack et al., 2012). The resulting topics reflect the underlying semantic structure of neuroimaging studies while simultaneously yielding more robust meta-analytic maps for individual features. Each study in the database has a load weight to each topic reflecting the semantics of the text. 

To estimate discriminability for each region, we trained a classifier to discriminate between studies that activated that region versus studies that did not. We defined ‘active’ studies as those that activated at least 50 voxels in the ROI and ‘inactive’ as those that did not activate any voxels. Active studies were labeled as the positive class (coded as 1) and inactive studies were labeled as the negative class (coded as 0). Next, we trained a regularized linear regression with an l2-penalty, or ridge regression, to predict the label of each study in a region’s set. Ridge regression is well suited for classification with many co-linear features: large coefficients are penalized, resulting in a dense yet stable solution with class-leading predictive performance. We treated the regression as a binary classification problem by converting predictions for unseen data above 0.5 to 1 (‘positive’) and below 0.5 to 0 (‘negative’). To avoid overfitting, we tested our models using 4-fold cross validation. Each model was on trained 3/4ths of the data and asked to predict the class of the remaining 1/4th, circulating over the dataset such that the model was trained and tested on the entire dataset. The mean score across the four folds was used as the final measure of discriminability for each region. We scored the classifiers using by taking area under the curve of the receiver operating characteristic (auc-roc). This common classification metric, ranging from 0.5 for chance to 1 for flawless predictions, is not biased by the balance of sample sizes between the two classes, which can vary between regions. Finally, for each region, we extracted the regression weights for each topic (‘topic weights’); positive weights indicate the discussion of that topic in a study predict activity in the region, while negative weights indicate the topic is anti-predictive of activity. 

We estimated discriminability for four parcellations of the brain that varied in resolution. We defined regions by clustering voxels together with similar coactivation profiles across studies in the database. We used Ward clustering to group voxels into 10, 20, 30, 40, 50 and 60 clusters. Consistent with the topology of the human brain, clusters consisted of contagious voxels or bilateral structures.

Next, for each region we calculated how many features are necessary for sucessfull classification. First, we took the absolute value of the topic weights for every region, to determine which regions were most useful in classification. Next, we reran classification 80 times, starting with only the most useful feature as data, and progressively adding more features ordered by their absolute topic weight. 

### Pairwise classification

## Results
### Discriminability across the brain
Mean discriminability across the four parcellations was above chance (mean auc-roc = 0.57) and peaked when using 20 regions (Figure 1). The low accuracy using 10 regions suggests that at this resolution regions are too heterogeneous to be accurately discriminated, supported by the fact that the regions with most voxels in that parcellation were the most difficult to discriminate. However, increasing the resolution past 20 regions led to a slow decrease in discriminability. Less studies activated each region as the resolution increased, ranging from a mean of 4858 studies per region using 10 parcels to 1706 with 60 regions, suggesting that there was insufficient data to support training at high resolutions. Henceforth, we focus on the results using 40 regions as they strike a balance between resolution and performance.

Regional discriminability showed wide variability across regions, ranging from near chance, for motor cortex, performance to robust classification, for the superior parietal lobule (Figure 2, auc-roc range: 0.51 - 0.65). Discriminability was slightly lower for larger regions (r = 0.12), but this effect is sufficiently small to allow for comparison across parcels of different size (see Supplemental Materials). 

Regions also varied in the topics that were predictive of their activation. In Figure 3, we plot the topic weights for each region, arranged by the region’s discriminability. Predictive topics are consistent with existing knowledge about function to anatomy mappings. For example, for auditory cortex, a region that was highly discriminable, the most predictive topic was most associated with the words ’speech, auditory, and sounds’. Likewise, bilateral amygdala, a moderately discriminable region, was most predicted by a topic most associated with the word ‘emotional’. Even regions with low discriminability, such as right middle frontal gyrus, was most predicted by a topic about ‘inhibition, conflict, and control’, consistent with the role of lateral prefrontal cortex in cognitive control.

While most regions seem to be most predicted by a topic related to its known cognitive function, we asked if the discriminability of a region affected the strength or distribution of the topic weights. In other words, do more discriminable regions have stronger relationships to specific cognitive phenomena? Discriminability did not correlate with overall topic weights, but did correlate with the absolute value of the weights. This suggests more discriminable regions have stronger associations with specific cognitive topics, in both positive and negative directions. For example, the parietal lobule is easily discriminable and activity within it is strongly anti-predicted by the topic described the words ‘wm’ , ‘integrity’.

Next, we sought to determine for each region how many functions are necessary to succesfully perform classification. We reran classificaiton only using the most predictive features from the full model for each region, and progressively added features ordered by their topic weight. Regions varied substantially in the number of features necessary to achieve classification near the levels obtained using the full model. For example, 








